# PERIDOT用Rubicファームウェア
## 準備
RBF-WRITERを用いて、このフォルダにある plain\_plain\_epcs4\_auto.rpd をPERIDOTボードに書き込んでおいてください。
この操作は各ボードにつき一回のみで十分です。RBF-WRITERでは、rbfファイルだけでなくrpdファイルも直接扱えますので、
上記のファイルを直接ドラッグ＆ドロップすれば書き込みできます。

## 開発の手順
1. PERIDOTボードのスイッチをAS側にして、PCに接続する。
2. Rubicを起動し、既存のスケッチを開くか、新しいスケッチを書く。
3. Rubic画面下のボード画面から「PERIDOT」と「COMxx」を選択し、RUNをクリックする。

## 対応バージョン
- ハードウェア(PERIDOTボード) : 1.1 (1.0でもおそらく動作しますが、未確認です)
- 開発ソフトウェア(Rubic) : 0.1.0

## mrubyバージョン
- mruby 1.1.0 (RITE0003)

## 生成元情報
- Path: https://github.com/kimushu/peridot/tree/feature/rubic/fpga/peridot_rubic
- Commit: c8ff38c2d7114918472f6f019174748730fdea38

## ペリフェラル構成
START LED(ボード右上)およびデジタル信号ピン(D0～D27)を制御するGPIOのみが搭載されています。

## クラスライブラリ(PIOCoreクラス)

### インスタンスメソッド
**width -> Integer**  
    割り当てられたビット数を返します。

**slice(range) -> PIOCore**  
**self[] -> PIOCore**  
    rangeで指定された一部のビットのみを操作するための、新しいインスタンスを生成します。

**high -> self**  
**set -> self**  
    ピンの出力値をHigh(1)に設定します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。
    なお、入出力方向は変更されません。

**clear -> self**  
**set -> self**  
    ピンの出力値をLow(0)に設定します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。
    なお、入出力方向は変更されません。

**high? -> bool**  
**set? -> bool**  
    単一ビットのピンの入力値がHigh(1)であればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**low? -> bool**  
**cleared? -> bool**  
    単一ビットのピンの入力値がLow(0)であればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**toggle -> self**  
    ピンの出力値を反転(High→Low, Low→High)します。複数ビットが割り当てられているインスタンスの場合、
    各々のビットが反転します。

**assert -> self**  
**on -> self**  
    ピンの出力値を「真」の論理レベルに設定します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。「真」としてHigh/Lowのどちらを用いるかは、各々のビットの
    正論理/負論理設定で決定されます。なお、入出力方向は変更されません。

**negate -> self**  
**off -> self**  
    ピンの出力値を「偽」の論理レベルに設定します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。「偽」としてHigh/Lowのどちらを用いるかは、各々のビットの
    正論理/負論理設定で決定されます。なお、入出力方向は変更されません。

**asserted? -> bool**  
    単一ビットのピンの入力値が「真」の論理レベルであればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。
    「真」としてHigh/Lowのどちらを用いるかは、ビットの正論理/負論理設定で決定されます。

**negated? -> bool**  
    単一ビットのピンの入力値が「偽」の論理レベルであればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。
    「偽」としてHigh/Lowのどちらを用いるかは、ビットの正論理/負論理設定で決定されます。

**enable\_output -> self**  
    ピンの入出力方向を出力に変更します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。

**disable\_output -> self**  
    ピンの入出力方向を入力に変更します。複数ビットが割り当てられているインスタンスの場合、
    割り当てられた全ビットが設定されます。

**output\_enabled? -> bool**  
    単一ビットのピンの入出力方向が出力に設定されていればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**output\_disabled? -> bool**  
    単一ビットのピンの入出力方向が入力に設定されていればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**active\_high -> self**  
    ピンの論理を正論理に設定します。つまり、真＝High、偽＝Lowとなります。
    複数ビットが割り当てられているインスタンスの場合、割り当てられた全ビットが設定されます
    なお、assertメソッドやnegateメソッドで出力設定をした後に本メソッドで論理を変更しても、
    ピンの出力レベル(HighまたはLow)は自動で変更されません。

**active\_low -> self**  
    ピンの論理を負論理に設定します。つまり、真＝Low、偽＝Highとなります。
    複数ビットが割り当てられているインスタンスの場合、割り当てられた全ビットが設定されます
    なお、assertメソッドやnegateメソッドで出力設定をした後に本メソッドで論理を変更しても、
    ピンの出力レベル(HighまたはLow)は自動で変更されません。

**active\_high? -> bool**  
    単一ビットのピンの論理が正論理に設定されていればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**active\_low? -> bool**  
    単一ビットのピンの論理が負論理に設定されていればtrueを返します。複数ビットが割り当てられている
    インスタンスで呼び出された場合、エラー(TypeError)が発生します。

**value -> Integer**  
    ビットの入力値を整数で返します。返す整数の範囲は、割り当てられたビット数をWとすると
    0以上(2のW乗)未満です。入力レベルのHighはそのまま1と解釈され、正論理/負論理の設定は
    反映されません。

**value=(bits)**  
    ビットの出力値を整数で指定して設定します。各ビットの1はそのままHighレベル出力と解釈されます。
    正論理/負論理の設定は反映されません。割り当てられたビット数を超えるビットは無視されます。

